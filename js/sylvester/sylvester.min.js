/**
* Sylvester is © 2007–2012 James Coglan, and is released under the MIT license. 
* This is a slimmed-down version by Willem Mulder for the sole purpose of inversing a matrix.
* Also released under the MIT license.
*/

var Sylvester={precision:1e-6};Sylvester.Matrix=function(){};Sylvester.Matrix.create=function(a){var b=new Sylvester.Matrix;return b.setElements(a)};var $M=Sylvester.Matrix.create;Sylvester.Matrix.I=function(a){var b=[],c=a,d;while(c--){d=a;b[c]=[];while(d--){b[c][d]=c===d?1:0}}return Sylvester.Matrix.create(b)};Sylvester.Matrix.prototype={e:function(a,b){if(a<1||a>this.elements.length||b<1||b>this.elements[0].length){return null}return this.elements[a-1][b-1]},row:function(a){if(a>this.elements.length){return null}return Sylvester.Vector.create(this.elements[a-1])},col:function(a){if(this.elements.length===0){return null}if(a>this.elements[0].length){return null}var b=[],c=this.elements.length;for(var d=0;d<c;d++){b.push(this.elements[d][a-1])}return Sylvester.Vector.create(b)},dimensions:function(){var a=this.elements.length===0?0:this.elements[0].length;return{rows:this.elements.length,cols:a}},rows:function(){return this.elements.length},cols:function(){if(this.elements.length===0){return 0}return this.elements[0].length},dup:function(){return Sylvester.Matrix.create(this.elements)},isSquare:function(){var a=this.elements.length===0?0:this.elements[0].length;return this.elements.length===a},toRightTriangular:function(){if(this.elements.length===0)return Sylvester.Matrix.create([]);var a=this.dup(),b;var c=this.elements.length,d,e,f=this.elements[0].length,g;for(d=0;d<c;d++){if(a.elements[d][d]===0){for(e=d+1;e<c;e++){if(a.elements[e][d]!==0){b=[];for(g=0;g<f;g++){b.push(a.elements[d][g]+a.elements[e][g])}a.elements[d]=b;break}}}if(a.elements[d][d]!==0){for(e=d+1;e<c;e++){var h=a.elements[e][d]/a.elements[d][d];b=[];for(g=0;g<f;g++){b.push(g<=d?0:a.elements[e][g]-a.elements[d][g]*h)}a.elements[e]=b}}}return a},determinant:function(){if(this.elements.length===0){return 1}if(!this.isSquare()){return null}var a=this.toRightTriangular();var b=a.elements[0][0],c=a.elements.length;for(var d=1;d<c;d++){b=b*a.elements[d][d]}return b},isSingular:function(){return this.isSquare()&&this.determinant()===0},augment:function(a){if(this.elements.length===0){return this.dup()}var b=a.elements||a;if(typeof b[0][0]==="undefined"){b=Sylvester.Matrix.create(b).elements}var c=this.dup(),d=c.elements[0].length;var e=c.elements.length,f=b[0].length,g;if(e!==b.length){return null}while(e--){g=f;while(g--){c.elements[e][d+g]=b[e][g]}}return c},inverse:function(){if(this.elements.length===0){return null}if(!this.isSquare()||this.isSingular()){return null}var a=this.elements.length,b=a,c;var d=this.augment(Sylvester.Matrix.I(a)).toRightTriangular();var e=d.elements[0].length,f,g,h;var i=[],j;while(b--){g=[];i[b]=[];h=d.elements[b][b];for(f=0;f<e;f++){j=d.elements[b][f]/h;g.push(j);if(f>=a){i[b].push(j)}}d.elements[b]=g;c=b;while(c--){g=[];for(f=0;f<e;f++){g.push(d.elements[c][f]-d.elements[b][f]*d.elements[c][b])}d.elements[c]=g}}return Sylvester.Matrix.create(i)},setElements:function(a){var b,c,d=a.elements||a;if(d[0]&&typeof d[0][0]!=="undefined"){b=d.length;this.elements=[];while(b--){c=d[b].length;this.elements[b]=[];while(c--){this.elements[b][c]=d[b][c]}}return this}var e=d.length;this.elements=[];for(b=0;b<e;b++){this.elements.push([d[b]])}return this}};Sylvester.Matrix.prototype.toUpperTriangular=Sylvester.Matrix.prototype.toRightTriangular;Sylvester.Matrix.prototype.det=Sylvester.Matrix.prototype.determinant;Sylvester.Matrix.prototype.tr=Sylvester.Matrix.prototype.trace;Sylvester.Matrix.prototype.rk=Sylvester.Matrix.prototype.rank;Sylvester.Matrix.prototype.inv=Sylvester.Matrix.prototype.inverse;Sylvester.Matrix.prototype.x=Sylvester.Matrix.prototype.multiply